<analysis>**original_problem_statement:**
The user requested a standalone web application to track retail and wholesale orders originating from WhatsApp.

**PRODUCT REQUIREMENTS:**
- **User Management:** Role-based access control (Showroom, Corporate Sales, Warehouse, etc.) with JWT authentication.
- **Product Management:** Full CRUD for products, including a 14,000+ product CSV import, search, list/grid views, and bulk deletion.
- **Order Management:**
    - A dynamic, multi-step order creation form that changes based on the selected Order Type (e.g., Retail, Corporate).
    - VKN/TCKN (Turkish tax/ID) validation with conditional fields (e.g., a Company Name field for VKN).
    - Product search across the entire catalog during order entry.
    - Separate statuses for , , , and .
    - Detailed order history log for all status changes and notes.
    - Ability to edit and delete existing orders.
    - Role-based order code prefixes (e.g.,  for Admin,  for Showroom).
    - Advanced filtering on the order list page.
    - Additional fields for payment/delivery tracking (POS payment, online payment reference).
- **PDF Generation:** Generation of professional-looking PDF quotes with correct Turkish character rendering, a custom layout, and configurable company logo and bank details.
- **Settings:** A page to manage application settings like Order Types and PDF content.

**User's preferred language**: Turkish. The next agent MUST respond in Turkish.

**what currently exists?**
A full-stack FastAPI/React/MongoDB application has been built. It includes JWT authentication and a comprehensive set of features: full CRUD for Users, Products, and Orders. Product management supports bulk CSV import, bulk deletion, and robust search. The order system is highly advanced, featuring a dynamic creation form based on order type, VKN/TCKN validation, order editing, status management, a detailed history log, order deletion, and advanced filtering. The PDF generation feature has been fixed to support Turkish characters and a professional layout, with company details managed from a settings page.

**Last working item**:
- **Last item agent was working:** The agent was implementing user-requested features for corporate orders. The latest request is to have separate billing and shipping addresses for corporate-type orders. The agent has just acknowledged the request. Immediately prior to this, the agent was working on changing order code prefixes to be based on the creator's role (e.g.,  for Admin). This feature is partially implemented.
- **Status:** NOT STARTED (for the new address feature). The role-based prefix feature is IN PROGRESS.
- **Agent Testing Done:** N
- **Which testing method agent to use?** both. The backend needs new fields in the Order model and updates to the creation/update endpoints. The frontend requires significant changes to  and  to add the new address forms. The frontend testing agent would be ideal after implementation.
- **User Testing Done:** N

**All Pending/In progress Issue list**:
- **Issue 1:** Implement separate billing and shipping addresses for corporate orders. (P0)
- **Issue 2:** Complete and verify role-based order code prefixes. (P1)

**Issues Detail:**
- **Issue 1:**
    - **Attempted fixes:** None. This is a new request.
    - **Next debug checklist:**
        1. In , modify the  and  Pydantic models to include  and  fields. These could be objects or individual fields (e.g., , , etc.).
        2. In , when a Kurumsal (Corporate) order type is selected, conditionally render two separate address forms: one for billing and one for shipping.
        3. Add a Use same address for shipping checkbox for user convenience.
        4. Update the  function to send both addresses to the backend.
        5. In , update the UI to display both billing and shipping addresses clearly.
    - **Why fix this issue and what will be achieved with the fix?** To meet the user's requirement for handling corporate clients who often have different locations for invoicing and delivery.
    - **Status:** NOT STARTED
    - **Is recurring issue?** N
    - **Should Test frontend/backend/both after fix?** Both
    - **Blocked on other issue:** None.

- **Issue 2:**
    - **Attempted fixes:** The agent updated  to generate an order prefix based on the user's role. It was tested for the  role (), which worked. However, the test for a  user was interrupted.
    - **Next debug checklist:**
        1. In , review the  function to ensure prefixes are defined for all user roles (e.g., , , ).
        2. Create test users for each relevant role.
        3. Log in as each user and create an order.
        4. Verify that the generated  has the correct role-specific prefix.
    - **Why fix this issue and what will be achieved with the fix?** To fulfill the user's request for easily identifying which department or user created an order by its code.
    - **Status:** IN PROGRESS
    - **Is recurring issue?** N
    - **Should Test frontend/backend/both after fix?** Backend
    - **Blocked on other issue:** None.

**In progress Task List**:
None.

**Upcoming and Future Tasks**
None. All known user requests are captured in the pending issue list.

**Completed work in this session**
- **PDF Generation Overhaul:** Fixed Turkish character encoding and redesigned the layout to match a professional template. Added settings for a dynamic company logo and bank accounts.
- **CSV Product Import Fix:** Corrected the CSV parsing logic to handle semicolon delimiters and BOM characters, successfully importing over 14,000 products.
- **Order Management Enhancements:**
    - Implemented robust order editing and a detailed order history log.
    - Added separate, filterable statuses for , , , and .
    - Implemented a backend-powered product search in the order form to handle the large product catalog.
    - Added comprehensive filtering to the main orders list page.
    - Implemented VKN/TCKN validation with conditional fields.
    - Created a dynamic order form that changes based on the selected order type (e.g., Retail vs. Corporate).
    - Added a manual Company Name field for corporate orders.
    - Implemented order deletion.
- **Product Management:** Implemented bulk product deletion and fixed a critical route-ordering bug related to it.

**Earlier issues found/mentioned but not fixed**
None.

**Known issue recurrence from previous fork**
N/A

**Code Architecture**


**Key Technical Concepts**
- **Backend:** FastAPI, Pydantic (with ), MongoDB (), JWT, Passlib, ReportLab.
- **Frontend:** React (Hooks), React Router, Context API, TailwindCSS, Shadcn/UI, Debounce.
- **Architecture:** Monolithic API backend with a SPA frontend.

**key DB schema**
- **users**: 
- **products**: 
- **orders**: 
- **bank_accounts**: 
- **pdf_settings**: 

**changes in tech stack**
None.

**All files of reference**
- : Contains all backend logic. Key functions to check are , , and the / Pydantic models.
- : The complex, multi-step order creation form. Will need modification for the address fields.
- : Displays order details. Will need modification to show new addresses and the role-based order code.
- : The main order list with filtering.
- : Product management page with bulk actions.

**Areas that need refactoring**:
-  is a very large monolith. Splitting it into , , and  would significantly improve maintainability.
-  is also becoming very large and complex due to the dynamic, multi-step logic. It could be broken down into smaller sub-components.

**key api endpoints**
-  (GET, POST)
-  (GET, PUT, DELETE)
-  (POST)
-  (DELETE)
-  (POST)
-  (GET, POST, DELETE)
-  (GET, POST)

**Critical Info for New Agent**
- The immediate priority is the user's latest request: adding separate billing and shipping addresses for corporate orders (Issue #1).
- After that, you must complete the implementation and testing of role-based order prefixes (Issue #2).
- The user is highly engaged and provides frequent, incremental requests. Expect to work in a tight feedback loop.
- The backend  and frontend  files are very large. Be careful when modifying them.

**documents and test_reports created in this job**
-  (From the successful PDF generation test)

**Last 10 User Messages and any pending HUMAN messages**
- 
- 
- 
- 
- 
- 
- 
- 
- 
- 

**Project Health Check:**
- **Broken:** None. All implemented features are working.
- **Mocked:** None.

**3rd Party Integrations**
None.

**Testing status**
- **Testing agent used after significant changes:** YES (for the PDF generation feature).
- **Troubleshoot agent used after agent stuck in loop:** NO
- **Test files created:** None.
- **Known regressions:** None.

**Credentials to test flow:**
Default users are created in . Use  /  for full access. New users for other roles may need to be created for testing Issue #2.

**What agent forgot to execute**
The agent did not complete the testing for the role-based order prefix feature. It was tested for the 'admin' role but not for other roles like 'showroom', 'corporate_sales', etc., before the user provided a new, higher-priority task.</analysis>
